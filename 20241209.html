<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
</head>
<body>
    <table class="table table-hover">
        <thead>
            <tr>
                <th>探測地點</th>
                <th>日期</th>
                <th>當日雨量</th>
            </tr>
        </thead>
        <tbody id="insert-here">
            <tr>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-2"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-6"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-3"></span>
                    </span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-2"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-6"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-3"></span>
                    </span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-2"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-6"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-3"></span>
                    </span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-2"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-6"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-3"></span>
                    </span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-2"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-6"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-3"></span>
                    </span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-2"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-6"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-3"></span>
                    </span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-2"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-6"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-3"></span>
                    </span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-2"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-6"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-3"></span>
                    </span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-2"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-6"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-3"></span>
                    </span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-2"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-6"></span>
                    </span>
                </td>
                <td>
                    <span class="placeholder-glow">
                        <span class="placeholder col-3"></span>
                    </span>
                </td>
            </tr>
        </tbody>
    </table>
    
    <div id="chart">
        
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script>
        var table = document.getElementById("insert-here");
        fetch("https://data.moenv.gov.tw/api/v2/aqx_p_20?api_key=e8dd42e6-9b8b-43f8-991e-b3dee723a52d&limit=1000&sort=ImportDate desc&format=JSON")
          /*callback function*/
        .then(function(res){
            return res.json();
        })
        .then(function(mainData){
            table.innerHTML = "";
            let dateArr = [];
            let amountArr = [];
            mainData.records.forEach(function(record){
                if(record.sitename=="富貴角"){
                    let tr = document.createElement("tr");

                    let location = document.createElement("td");
                    location.innerText=record.sitename;
                    tr.appendChild(location);

                    let date = document.createElement("td");
                    date.innerText=record.monitordate;
                    tr.appendChild(date);
                    dateArr.push(record.monitordate);

                    let amount = document.createElement("td");
                    amount.innerText=record.rainfall24hr+" "+record.itemunit;
                    tr.appendChild(amount);
                    amountArr.push(record.rainfall24hr);

                    table.appendChild(tr);
                }
            });
            var options = {
                series: [{
                data: amountArr
                }],
                chart: {
                type: 'bar',
                height: 350
                },
                plotOptions: {
                bar: {
                    borderRadius: 4,
                    borderRadiusApplication: 'end',
                    horizontal: true,
                }
                },
                dataLabels: {
                enabled: false
                },
                xaxis: {
                categories: dateArr,
                }
                };

                var chart = new ApexCharts(document.querySelector("#chart"), options);
                chart.render();
        })
          /*callback function*/
        .catch(function(error){
            console.log(error);
        });
        console.log("next move");
    </script>
</body>
</html>